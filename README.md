# ì–´ë‘ ì˜ì „ì„¤ M (Legend of Darkness M)

ë„¥ìŠ¨ì˜ ì–´ë‘ ì˜ì „ì„¤(Legend of Darkness) ìŠ¤íƒ€ì¼ì˜ **ì˜¨ë¼ì¸ í”½ì…€ RPG ê²Œì„**

**Rust + Bevy 0.15 + Axum 0.8 + SQLx 0.8 + PostgreSQL 18**

---

## ğŸ® Bevyë€?

> **BevyëŠ” ë„¤ì´í‹°ë¸Œ ë°ìŠ¤í¬í†± ê²Œì„ ì—”ì§„ì…ë‹ˆë‹¤.**

| íŠ¹ì§•          | ì„¤ëª…                                 |
| ------------- | ------------------------------------ |
| **ì‹¤í–‰ ë°©ì‹** | ë°ìŠ¤í¬í†± ì•± (Windows/Mac/Linux)      |
| **ë¹Œë“œ í•„ìš”** | `cargo build` í›„ ì‹¤í–‰ íŒŒì¼ ì‹¤í–‰      |
| **ì›¹ ì§€ì›**   | WASM ë¹Œë“œ ê°€ëŠ¥ (ë³„ë„ ì„¤ì • í•„ìš”)      |
| **ì¥ì **      | ê²Œì„ ë£¨í”„, ìŠ¤í”„ë¼ì´íŠ¸, ë¬¼ë¦¬ì—”ì§„ ë‚´ì¥ |

---

## ğŸ›‘ ê°œë°œ í™˜ê²½ ì ˆëŒ€ ì›ì¹™

> **"Host OSì—ëŠ” Dockerë§Œ ì„¤ì¹˜. ë‹¨, ê²Œì„ í´ë¼ì´ì–¸íŠ¸ëŠ” ë¡œì»¬ Rustë¡œ ì‹¤í–‰."**

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### 1. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

```bash
cp .env.example .env
```

### 2. ì„œë¹„ìŠ¤ ì‹¤í–‰ (ì›¹ ê²Œì„ + API + DB)

ëª¨ë“  ê°œë°œ ë° ì‹¤í–‰ì€ Docker ì»¨í…Œì´ë„ˆ ë‚´ì—ì„œ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.

```bash
docker compose up -d
```

ì ‘ì† ì •ë³´:

- ğŸ® **ì›¹ ê²Œì„ ì ‘ì†**: [http://localhost:8080](http://localhost:8080)
- ğŸ”Œ **API ì„œë²„**: [http://localhost:3000](http://localhost:3000)
- ğŸ—„ï¸ **DB ê´€ë¦¬ì**: [http://localhost:8081](http://localhost:8081)

---

## ğŸ› ï¸ ê°œë°œ ë° ë¹Œë“œ ê°€ì´ë“œ (Dev Container)

ê°œë°œ í™˜ê²½ì— ì•„ë¬´ê²ƒë„ ì„¤ì¹˜í•  í•„ìš” ì—†ì´ `docker compose` ëª…ë ¹ë§Œìœ¼ë¡œ ëª¨ë“  ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### 1. ì›¹(Web/WASM) ê°œë°œ ë° ì‹¤ì‹œê°„ í™•ì¸

`docker compose up`ì„ ì‹¤í–‰í•˜ë©´ ì´ë¯¸ ì›¹ ì„œë²„ê°€ 8080 í¬íŠ¸ì—ì„œ ì‹¤í–‰ ì¤‘ì…ë‹ˆë‹¤. ì½”ë“œë¥¼ ìˆ˜ì •í•˜ë©´ ìë™ìœ¼ë¡œ ë‹¤ì‹œ ë¹Œë“œë˜ì–´ ë¸Œë¼ìš°ì €ì— ë°˜ì˜ë©ë‹ˆë‹¤.

ë§Œì•½ ë¡œê·¸ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ë³´ê±°ë‚˜ ë…ë¦½ì ìœ¼ë¡œ ì‹¤í–‰í•˜ê³  ì‹¶ë‹¤ë©´:

```bash
docker compose logs -f web
```

### 2. ë„¤ì´í‹°ë¸Œ(Native) ë¹Œë“œ

ë°ìŠ¤í¬í†± ì‹¤í–‰ íŒŒì¼(Windows/Linux)ì„ ë¹Œë“œí•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.

```bash
# ë„¤ì´í‹°ë¸Œ ë°”ì´ë„ˆë¦¬ ë¹Œë“œ (target/debug/legend-game)
docker compose run --rm game cargo build --bin legend-game --features client

# ë¦´ë¦¬ì¦ˆ ë¹Œë“œ (ìµœì í™” ë²„ì „)
docker compose run --rm game cargo build --bin legend-game --features client --release
```

### 3. ë°ì´í„°ë² ì´ìŠ¤ ê´€ë¦¬ (Migration)

DB ìŠ¤í‚¤ë§ˆë¥¼ ë³€ê²½í•˜ê±°ë‚˜ ë°ì´í„°ë¥¼ ì—…ë°ì´íŠ¸í•  ë•Œ ì‚¬ìš©í•©ë‹ˆë‹¤.

```bash
# ìƒˆë¡œìš´ ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ ìƒì„±
docker compose run --rm api sqlx migrate add [ì´ë¦„]

# ë§ˆì´ê·¸ë ˆì´ì…˜ ì ìš©
docker compose run --rm api sqlx migrate run
```

---

## ğŸŒ ì›¹ ë°°í¬ìš© ì •ì  ë¹Œë“œ

ìµœì¢… ë°°í¬ë¥¼ ìœ„í•œ ì •ì  íŒŒì¼(HTML/JS/WASM)ì„ ìƒì„±í•©ë‹ˆë‹¤.

```bash
docker compose run --rm game trunk build --release
```

ë¹Œë“œ ê²°ê³¼ë¬¼ì€ `dist/` í´ë”ì— ìƒì„±ë©ë‹ˆë‹¤. ì´ í´ë”ì˜ ë‚´ìš©ë¬¼ì„ ì •ì  ì›¹ ì„œë²„(Nginx, S3 ë“±)ì— ì˜¬ë¦¬ë©´ ë°°í¬ê°€ ì™„ë£Œë©ë‹ˆë‹¤.

---

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
legend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ game_main.rs          # ğŸ® Bevy ê²Œì„ ì—”íŠ¸ë¦¬í¬ì¸íŠ¸
â”‚   â”œâ”€â”€ server_main.rs        # ğŸ”Œ Axum API ì„œë²„ ì—”íŠ¸ë¦¬í¬ì¸íŠ¸
â”‚   â”œâ”€â”€ lib.rs                # ë¼ì´ë¸ŒëŸ¬ë¦¬ ë£¨íŠ¸
â”‚   â”‚
â”‚   â”œâ”€â”€ client/               # ğŸ® Bevy ê²Œì„ í´ë¼ì´ì–¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ mod.rs            # LegendGamePlugin (ë©”ì¸ í”ŒëŸ¬ê·¸ì¸)
â”‚   â”‚   â”œâ”€â”€ states.rs         # GameState (Loading, Menu, Playing...)
â”‚   â”‚   â”œâ”€â”€ components.rs     # ECS ì»´í¬ë„ŒíŠ¸ë“¤
â”‚   â”‚   â”œâ”€â”€ resources.rs      # ê²Œì„ ë¦¬ì†ŒìŠ¤ë“¤ (ìŠ¤í”„ë¼ì´íŠ¸ í•¸ë“¤ í¬í•¨)
â”‚   â”‚   â”œâ”€â”€ systems.rs        # ì¹´ë©”ë¼, ì—ì…‹ ë¡œë”©
â”‚   â”‚   â”œâ”€â”€ ui.rs             # ë©”ë‰´, HUD
â”‚   â”‚   â””â”€â”€ game.rs           # ì›”ë“œ, í”Œë ˆì´ì–´, ëª¬ìŠ¤í„°, ì „íˆ¬
â”‚   â”‚
â”‚   â”œâ”€â”€ server/               # ğŸ”Œ Axum REST API
â”‚   â”‚   â”œâ”€â”€ auth.rs           # ë¡œê·¸ì¸/íšŒì›ê°€ì…
â”‚   â”‚   â”œâ”€â”€ db.rs             # DB ì—°ê²°
â”‚   â”‚   â””â”€â”€ monsters.rs       # ëª¬ìŠ¤í„° API
â”‚   â”‚
â”‚   â””â”€â”€ shared/               # ğŸ“¦ ê³µìš© ëª¨ë“ˆ
â”‚       â”œâ”€â”€ domain/           # ë„ë©”ì¸ ëª¨ë¸
â”‚       â”‚   â”œâ”€â”€ character/    # Player, PlayerClass, StatType
â”‚       â”‚   â”œâ”€â”€ monster/      # Monster, MonsterAI, SpriteSize
â”‚       â”‚   â”œâ”€â”€ item/         # Item, Equipment
â”‚       â”‚   â”œâ”€â”€ skill/        # Skill
â”‚       â”‚   â”œâ”€â”€ map/          # GameMap, Tile
â”‚       â”‚   â””â”€â”€ shared/       # Stats, Position, Direction
â”‚       â”‚
â”‚       â””â”€â”€ data/             # ğŸ“Š ì •ì  ë°ì´í„° ìƒìˆ˜ (const)
â”‚           â”œâ”€â”€ mod.rs        # ë°ì´í„° ëª¨ë“ˆ ë£¨íŠ¸
â”‚           â”œâ”€â”€ assets.rs     # ì—ì…‹ ê²½ë¡œ ìƒìˆ˜
â”‚           â”œâ”€â”€ monsters.rs   # ëª¬ìŠ¤í„° ì •ì˜ (ìŠ¤íƒ¯, ìŠ¤í”„ë¼ì´íŠ¸, ë“œë¡­)
â”‚           â”œâ”€â”€ characters.rs # í´ë˜ìŠ¤ ì •ì˜ (ê¸°ë³¸ ìŠ¤íƒ¯, ìŠ¤í”„ë¼ì´íŠ¸)
â”‚           â”œâ”€â”€ skills.rs     # ìŠ¤í‚¬ ì •ì˜ (ë°ë¯¸ì§€, í, ë²„í”„)
â”‚           â”œâ”€â”€ items.rs      # ì•„ì´í…œ ì •ì˜ (ë¬´ê¸°, ë°©ì–´êµ¬, ì†Œëª¨í’ˆ)
â”‚           â””â”€â”€ maps.rs       # ë§µ ì •ì˜ (íƒ€ì¼ ë ˆì´ì•„ì›ƒ, ìŠ¤í°)
â”‚
â”œâ”€â”€ public/assets/            # ê²Œì„ ì—ì…‹
â”‚   â”œâ”€â”€ characters/           # ìºë¦­í„° ìŠ¤í”„ë¼ì´íŠ¸ì‹œíŠ¸
â”‚   â”œâ”€â”€ monsters/             # ëª¬ìŠ¤í„° ìŠ¤í”„ë¼ì´íŠ¸ì‹œíŠ¸
â”‚   â”œâ”€â”€ tiles/                # íƒ€ì¼/ë¹Œë”©/ì¥ì‹ ìŠ¤í”„ë¼ì´íŠ¸
â”‚   â”œâ”€â”€ fonts/                # í°íŠ¸
â”‚   â””â”€â”€ audio/                # BGM, íš¨ê³¼ìŒ
â”‚
â”œâ”€â”€ migrations/               # SQLx ë§ˆì´ê·¸ë ˆì´ì…˜
â””â”€â”€ compose.yml               # Docker Compose
```

### ğŸ“š ê´€ë ¨ ë¬¸ì„œ

| ë¬¸ì„œ | ì„¤ëª… |
|------|------|
| [ASSETS.md](./ASSETS.md) | **ì—ì…‹ & ìŠ¤í”„ë¼ì´íŠ¸ ì‹œìŠ¤í…œ ë§ˆìŠ¤í„° ê°€ì´ë“œ** (í†µí•©ë³¸) |

---

## ğŸ›  ê¸°ìˆ  ìŠ¤íƒ

| ë¶„ë¥˜          | ê¸°ìˆ            | ë²„ì „                 |
| ------------- | -------------- | -------------------- |
| **ê²Œì„ ì—”ì§„** | Bevy           | 0.15                 |
| **ë°±ì—”ë“œ**    | Axum           | 0.8 (REST API)       |
| **DBMS**      | PostgreSQL     | 18 (Alpine)          |
| **ORM**       | SQLx           | 0.8                  |
| **ì–¸ì–´**      | Rust           | 1.85+ (Edition 2024) |
| **ì¸í”„ë¼**    | Docker Compose | -                    |

---

## ğŸ“Š ë°ì´í„° ì•„í‚¤í…ì²˜

### ì •ì  ë°ì´í„° (Rust const) vs ë™ì  ë°ì´í„° (DB)

| êµ¬ë¶„ | ì €ì¥ ìœ„ì¹˜ | ë°ì´í„° ì¢…ë¥˜ |
|------|----------|------------|
| **ì •ì  (const)** | `src/shared/data/*.rs` | ëª¬ìŠ¤í„°, ìŠ¤í‚¬, ì•„ì´í…œ, ë§µ, ê²½í—˜ì¹˜ í…Œì´ë¸” |
| **ë™ì  (DB)** | PostgreSQL | ìœ ì €, ìºë¦­í„°, ì¸ë²¤í† ë¦¬, ì§„í–‰ë„ |

### Characters í…Œì´ë¸” ì£¼ìš” í•„ë“œ

```sql
-- ë ˆë²¨/ê²½í—˜ì¹˜ (ë§Œë ™: 99)
level INT (1-99)
exp BIGINT              -- í˜„ì¬ ë ˆë²¨ ê²½í—˜ì¹˜
total_exp BIGINT        -- ëˆ„ì  ê²½í—˜ì¹˜

-- ì¶”ê°€ ìŠ¤íƒ¯ (ê¸°ë³¸ê°’ì€ í´ë˜ìŠ¤ constì—ì„œ)
bonus_str_stat INT      -- í˜ ë³´ë„ˆìŠ¤
bonus_dex_stat INT      -- ë¯¼ì²© ë³´ë„ˆìŠ¤
bonus_int_stat INT      -- ì§€ëŠ¥ ë³´ë„ˆìŠ¤
bonus_wis_stat INT      -- ì§€í˜œ ë³´ë„ˆìŠ¤
bonus_con_stat INT      -- ì²´ë ¥ ë³´ë„ˆìŠ¤
stat_points INT         -- ë¯¸ë°°ë¶„ í¬ì¸íŠ¸
```

### ìŠ¤íƒ¯ ëª…ëª… ê·œì¹™

ëª¨ë“  ìŠ¤íƒ¯ í•„ë“œëŠ” `_stat` ì ‘ë¯¸ì‚¬ ì‚¬ìš©:

| í•„ë“œëª… | ì„¤ëª… |
|--------|------|
| `str_stat` | Strength (í˜) - ë¬¼ë¦¬ ê³µê²©ë ¥ |
| `dex_stat` | Dexterity (ë¯¼ì²©) - í¬ë¦¬í‹°ì»¬, íšŒí”¼ |
| `int_stat` | Intelligence (ì§€ëŠ¥) - ë§ˆë²• ê³µê²©ë ¥ |
| `wis_stat` | Wisdom (ì§€í˜œ) - MP, ë§ˆë²• ë°©ì–´ë ¥ |
| `con_stat` | Constitution (ì²´ë ¥) - HP, ë¬¼ë¦¬ ë°©ì–´ë ¥ |

### ê²½í—˜ì¹˜ ì‹œìŠ¤í…œ

- **ë§Œë ™**: 99
- **ê³µì‹**: `exp_to_next = floor(100 * level^1.5)`
- **ë§Œë ™ ì´ ê²½í—˜ì¹˜**: 3,715,799
- **í…Œì´ë¸”**: `src/shared/data/characters.rs::EXP_TABLE`

---

## ğŸ—ï¸ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Bevy Game Client (Native App)               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ States  â”‚  â”‚   UI    â”‚  â”‚  Game   â”‚  â”‚ Systems â”‚    â”‚
â”‚  â”‚ Machine â”‚  â”‚ (Menu,  â”‚  â”‚ (World, â”‚  â”‚(Camera, â”‚    â”‚
â”‚  â”‚         â”‚  â”‚  HUD)   â”‚  â”‚ Combat) â”‚  â”‚ Input)  â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ HTTP (REST API)
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Axum REST API (Docker)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚  Auth   â”‚  â”‚Monsters â”‚  â”‚  Items  â”‚                 â”‚
â”‚  â”‚ Handler â”‚  â”‚ Handler â”‚  â”‚ Handler â”‚                 â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ SQLx
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                PostgreSQL 18 (Docker)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ ê²Œì„ ì¡°ì‘ë²•

| í‚¤                       | ë™ì‘               |
| ------------------------ | ------------------ |
| `W` `A` `S` `D` / í™”ì‚´í‘œ | ì´ë™ (ëŒ€ê°ì„  ì§€ì›) |
| `Space`                  | ê³µê²©               |
| `C`                      | ìºë¦­í„° ì°½ (ì˜ˆì •)   |
| `I`                      | ì¸ë²¤í† ë¦¬ (ì˜ˆì •)    |
| `K`                      | ìŠ¤í‚¬ ì°½ (ì˜ˆì •)     |

---

## âœ¨ Leptos â†’ Bevy ë§ˆì´ê·¸ë ˆì´ì…˜ ì´ìœ 

| Leptos (ì´ì „)       | Bevy (í˜„ì¬)                   |
| ------------------- | ----------------------------- |
| UI í”„ë ˆì„ì›Œí¬       | **ê²Œì„ ì—”ì§„**                 |
| ê²Œì„ ë£¨í”„ ì§ì ‘ êµ¬í˜„ | ë‚´ì¥ ê²Œì„ ë£¨í”„                |
| Canvas 2D ìˆ˜ë™ ê´€ë¦¬ | ìŠ¤í”„ë¼ì´íŠ¸/ë Œë”ë§ ìë™í™”      |
| ì›¹ ë¸Œë¼ìš°ì €ë§Œ ì§€ì›  | **ë„¤ì´í‹°ë¸Œ + WASM ëª¨ë‘ ì§€ì›** |
| ë””ë²„ê¹… ì–´ë ¤ì›€       | í’ë¶€í•œ ë””ë²„ê¹… ë„êµ¬            |

---

## ğŸ“‹ ë¡œë“œë§µ

- [x] Bevyë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜
- [x] ê¸°ë³¸ ì´ë™/ì „íˆ¬ ì‹œìŠ¤í…œ
- [x] ë©”ì¸ ë©”ë‰´ / ì§ì—… ì„ íƒ
- [x] ì •ì  ë°ì´í„° const ë¶„ë¦¬ (ëª¬ìŠ¤í„°, ìŠ¤í‚¬, ì•„ì´í…œ, ë§µ)
- [x] ê²½í—˜ì¹˜ í…Œì´ë¸” (Level 1-99)
- [x] ìŠ¤í”„ë¼ì´íŠ¸ ì‹œìŠ¤í…œ ê¸°ë°˜ êµ¬ì¶•
- [ ] ìŠ¤í”„ë¼ì´íŠ¸ ì• ë‹ˆë©”ì´ì…˜ (ì§„í–‰ ì¤‘)
- [ ] ë©€í‹°í”Œë ˆì´ì–´ (WebSocket)
- [ ] ì¸ë²¤í† ë¦¬ ì‹œìŠ¤í…œ
- [ ] ìŠ¤í‚¬ ì‹œìŠ¤í…œ
- [ ] WASM ì›¹ ë¹Œë“œ

---

**Made with ğŸ¦€ Rust + ğŸ® Bevy 0.15 + ğŸš€ Axum 0.8 + ğŸ˜ PostgreSQL**
